{ parameter
    (or (pair %launchExchange (address %token_address) (nat %token_amount))
        (pair %setLqtAddress (address %dex_address) (address %lqt_address))) ;
  storage
    (pair (pair (pair (pair (nat %counter) (big_map %default_metadata string bytes))
                      (pair (address %default_reserve)
                            (big_map %default_token_metadata
                               nat
                               (pair (nat %token_id) (map %token_info string bytes)))))
                (pair (pair (big_map %empty_allowances (pair (address %owner) (address %spender)) nat)
                            (big_map %empty_history string nat))
                      (pair (big_map %empty_tokens address nat)
                            (big_map %empty_user_investments
                               address
                               (pair (pair (or %direction (unit %aDD) (unit %rEMOVE)) (nat %token)) (mutez %xtz))))))
          (pair (big_map %swaps nat address) (big_map %token_to_swaps address address))) ;
  code { UNPAIR ;
         IF_LEFT
           { SELF_ADDRESS ;
             SWAP ;
             DIG 2 ;
             SWAP ;
             PAIR ;
             SWAP ;
             PAIR ;
             UNPAIR 3 ;
             DUP 3 ;
             CDR ;
             CDR ;
             DUP 3 ;
             CAR ;
             MEM ;
             IF { DROP 3 ; PUSH nat 3 ; FAILWITH }
                { AMOUNT ;
                  PUSH mutez 1 ;
                  SWAP ;
                  EDIV ;
                  IF_NONE { PUSH string "DIV by 0" ; FAILWITH } {} ;
                  CAR ;
                  DUP 4 ;
                  CAR ;
                  CDR ;
                  CAR ;
                  CDR ;
                  DUP 4 ;
                  CDR ;
                  SOME ;
                  PUSH string "tokenPool" ;
                  UPDATE ;
                  AMOUNT ;
                  PUSH mutez 1 ;
                  SWAP ;
                  EDIV ;
                  IF_NONE { PUSH string "DIV by 0" ; FAILWITH } {} ;
                  CAR ;
                  SOME ;
                  PUSH string "xtzPool" ;
                  UPDATE ;
                  DUP 5 ;
                  CAR ;
                  CDR ;
                  CDR ;
                  CDR ;
                  AMOUNT ;
                  DUP 6 ;
                  CDR ;
                  PUSH unit Unit ;
                  LEFT unit ;
                  PAIR ;
                  PAIR ;
                  SOME ;
                  SENDER ;
                  UPDATE ;
                  DUP 5 ;
                  CDR ;
                  AMOUNT ;
                  DUP 5 ;
                  PUSH bool False ;
                  PUSH bool False ;
                  DUP 9 ;
                  DUP 11 ;
                  CAR ;
                  PUSH address "tz1Ke2h7sDdakHJQh8WX4Z372du1KChsksyU" ;
                  DIG 9 ;
                  PUSH nat 0 ;
                  SOME ;
                  PUSH string "xtzVolume" ;
                  UPDATE ;
                  DIG 9 ;
                  DUP 14 ;
                  CAR ;
                  CAR ;
                  CDR ;
                  CAR ;
                  SWAP ;
                  PAIR ;
                  SWAP ;
                  PAIR ;
                  SWAP ;
                  PAIR ;
                  SWAP ;
                  PAIR ;
                  SWAP ;
                  PAIR ;
                  SWAP ;
                  PAIR ;
                  SWAP ;
                  PAIR ;
                  SWAP ;
                  PAIR ;
                  SWAP ;
                  PAIR ;
                  SWAP ;
                  PAIR ;
                  AMOUNT ;
                  NONE key_hash ;
                  PAIR ;
                  PAIR ;
                  UNPPAIIR ;
                  CREATE_CONTRACT
                    { parameter
                        (or (or (or (or (pair %addLiquidity
                                           (address %owner)
                                           (pair (nat %minLqtMinted) (pair (nat %maxTokensDeposited) (timestamp %deadline))))
                                        (unit %default))
                                    (or (pair %removeLiquidity
                                           (address %to)
                                           (pair (nat %lqtBurned)
                                                 (pair (mutez %minXtzWithdrawn) (pair (nat %minTokensWithdrawn) (timestamp %deadline)))))
                                        (pair %setBaker (option %baker key_hash) (bool %freezeBaker))))
                                (or (or (address %setLqtAddress) (address %setManager))
                                    (or (pair %tokenToToken
                                           (address %outputDexterContract)
                                           (pair (nat %minTokensBought)
                                                 (pair (address %to) (pair (nat %tokensSold) (timestamp %deadline)))))
                                        (pair %tokenToXtz
                                           (address %to)
                                           (pair (nat %tokensSold) (pair (mutez %minXtzBought) (timestamp %deadline)))))))
                            (or (or (address %updateReserve) (unit %updateTokenPool))
                                (or (nat %updateTokenPoolInternal)
                                    (pair %xtzToToken (address %to) (pair (nat %minTokensBought) (timestamp %deadline)))))) ;
                      storage
                        (pair (nat %tokenPool)
                              (pair (mutez %xtzPool)
                                    (pair (nat %lqtTotal)
                                          (pair (bool %selfIsUpdatingTokenPool)
                                                (pair (bool %freezeBaker)
                                                      (pair (address %manager)
                                                            (pair (address %tokenAddress)
                                                                  (pair (address %lqtAddress)
                                                                        (pair (big_map %history string nat)
                                                                              (pair (big_map %user_investments
                                                                                       address
                                                                                       (pair (pair (or %direction (unit %aDD) (unit %rEMOVE)) (nat %token)) (mutez %xtz)))
                                                                                    (address %reserve))))))))))) ;
                      code { UNPAIR ;
                             IF_LEFT
                               { IF_LEFT
                                   { IF_LEFT
                                       { IF_LEFT
                                           { UNPAIR 4 ;
                                             DUP 5 ;
                                             GET 7 ;
                                             IF { DROP 5 ; PUSH nat 2 ; FAILWITH }
                                                { DIG 3 ;
                                                  NOW ;
                                                  COMPARE ;
                                                  GE ;
                                                  IF { DROP 4 ; PUSH nat 3 ; FAILWITH }
                                                     { PUSH mutez 1 ;
                                                       DUP 5 ;
                                                       GET 3 ;
                                                       EDIV ;
                                                       IF_NONE { PUSH string "DIV by 0" ; FAILWITH } {} ;
                                                       CAR ;
                                                       AMOUNT ;
                                                       PUSH mutez 1 ;
                                                       SWAP ;
                                                       EDIV ;
                                                       IF_NONE { PUSH string "DIV by 0" ; FAILWITH } {} ;
                                                       CAR ;
                                                       SWAP ;
                                                       DUP ;
                                                       DUG 2 ;
                                                       DUP 7 ;
                                                       GET 5 ;
                                                       DUP 3 ;
                                                       MUL ;
                                                       EDIV ;
                                                       IF_NONE { PUSH string "DIV by 0" ; FAILWITH } {} ;
                                                       CAR ;
                                                       DUP 7 ;
                                                       CAR ;
                                                       DIG 2 ;
                                                       MUL ;
                                                       DIG 2 ;
                                                       SWAP ;
                                                       EDIV ;
                                                       IF_NONE
                                                         { PUSH string "DIV by 0" ; FAILWITH }
                                                         { UNPAIR ;
                                                           PUSH nat 0 ;
                                                           DIG 2 ;
                                                           COMPARE ;
                                                           EQ ;
                                                           IF {} { PUSH nat 1 ; ADD } } ;
                                                       DIG 4 ;
                                                       SWAP ;
                                                       DUP ;
                                                       DUG 2 ;
                                                       COMPARE ;
                                                       GT ;
                                                       IF { DROP 5 ; PUSH nat 4 ; FAILWITH }
                                                          { DIG 3 ;
                                                            DUP 3 ;
                                                            COMPARE ;
                                                            LT ;
                                                            IF { DROP 4 ; PUSH nat 5 ; FAILWITH }
                                                               { DUP 4 ;
                                                                 DUP 3 ;
                                                                 DUP 6 ;
                                                                 GET 5 ;
                                                                 ADD ;
                                                                 UPDATE 5 ;
                                                                 SWAP ;
                                                                 DUP ;
                                                                 DUG 2 ;
                                                                 DUP 6 ;
                                                                 CAR ;
                                                                 ADD ;
                                                                 UPDATE 1 ;
                                                                 AMOUNT ;
                                                                 DIG 5 ;
                                                                 GET 3 ;
                                                                 ADD ;
                                                                 UPDATE 3 ;
                                                                 DUP ;
                                                                 GET 17 ;
                                                                 SWAP ;
                                                                 DUP ;
                                                                 DUG 2 ;
                                                                 CAR ;
                                                                 SOME ;
                                                                 PUSH string "tokenPool" ;
                                                                 UPDATE ;
                                                                 PUSH mutez 1 ;
                                                                 DUP 3 ;
                                                                 GET 3 ;
                                                                 EDIV ;
                                                                 IF_NONE { PUSH string "DIV by 0" ; FAILWITH } {} ;
                                                                 CAR ;
                                                                 SOME ;
                                                                 PUSH string "xtzPool" ;
                                                                 UPDATE ;
                                                                 SWAP ;
                                                                 DUP ;
                                                                 DUG 2 ;
                                                                 GET 19 ;
                                                                 AMOUNT ;
                                                                 DUP 5 ;
                                                                 PUSH unit Unit ;
                                                                 LEFT unit ;
                                                                 PAIR ;
                                                                 PAIR ;
                                                                 SOME ;
                                                                 SENDER ;
                                                                 UPDATE ;
                                                                 DUP 3 ;
                                                                 DIG 2 ;
                                                                 DIG 3 ;
                                                                 CAR ;
                                                                 SOME ;
                                                                 PUSH string "tokenPool" ;
                                                                 UPDATE ;
                                                                 UPDATE 17 ;
                                                                 SWAP ;
                                                                 UPDATE 19 ;
                                                                 DUP ;
                                                                 SENDER ;
                                                                 SELF_ADDRESS ;
                                                                 DIG 4 ;
                                                                 SWAP ;
                                                                 PAIR ;
                                                                 SWAP ;
                                                                 PAIR ;
                                                                 SWAP ;
                                                                 PAIR ;
                                                                 UNPAIR 4 ;
                                                                 GET 13 ;
                                                                 CONTRACT %transfer (pair address (pair address nat)) ;
                                                                 IF_NONE { PUSH nat 0 ; FAILWITH } {} ;
                                                                 PUSH mutez 0 ;
                                                                 DIG 4 ;
                                                                 DIG 4 ;
                                                                 PAIR ;
                                                                 DIG 3 ;
                                                                 PAIR ;
                                                                 TRANSFER_TOKENS ;
                                                                 SWAP ;
                                                                 DUP ;
                                                                 DUG 2 ;
                                                                 GET 15 ;
                                                                 CONTRACT %mintOrBurn (pair (int %quantity) (address %target)) ;
                                                                 IF_NONE { PUSH nat 12 ; FAILWITH } {} ;
                                                                 PUSH mutez 0 ;
                                                                 DIG 4 ;
                                                                 INT ;
                                                                 DIG 5 ;
                                                                 SWAP ;
                                                                 PAIR ;
                                                                 TRANSFER_TOKENS ;
                                                                 DIG 2 ;
                                                                 NIL operation ;
                                                                 DIG 2 ;
                                                                 CONS ;
                                                                 DIG 2 ;
                                                                 CONS ;
                                                                 PAIR } } } } }
                                           { DROP ;
                                             DUP ;
                                             GET 7 ;
                                             IF { DROP ; PUSH nat 2 ; FAILWITH }
                                                { DUP ; AMOUNT ; DIG 2 ; GET 3 ; ADD ; UPDATE 3 ; NIL operation ; PAIR } } }
                                       { IF_LEFT
                                           { UNPAIR 5 ;
                                             DUP 6 ;
                                             GET 7 ;
                                             IF { DROP 6 ; PUSH nat 2 ; FAILWITH }
                                                { DIG 4 ;
                                                  NOW ;
                                                  COMPARE ;
                                                  GE ;
                                                  IF { DROP 5 ; PUSH nat 3 ; FAILWITH }
                                                     { PUSH mutez 0 ;
                                                       AMOUNT ;
                                                       COMPARE ;
                                                       GT ;
                                                       IF { DROP 5 ; PUSH nat 10 ; FAILWITH }
                                                          { DUP 5 ;
                                                            GET 5 ;
                                                            PUSH mutez 1 ;
                                                            DUP 7 ;
                                                            GET 3 ;
                                                            EDIV ;
                                                            IF_NONE { PUSH string "DIV by 0" ; FAILWITH } {} ;
                                                            CAR ;
                                                            DUP 4 ;
                                                            MUL ;
                                                            EDIV ;
                                                            IF_NONE { PUSH string "DIV by 0" ; FAILWITH } {} ;
                                                            CAR ;
                                                            PUSH mutez 1 ;
                                                            SWAP ;
                                                            MUL ;
                                                            DUP 6 ;
                                                            GET 5 ;
                                                            DUP 7 ;
                                                            CAR ;
                                                            DUP 5 ;
                                                            MUL ;
                                                            EDIV ;
                                                            IF_NONE { PUSH string "DIV by 0" ; FAILWITH } {} ;
                                                            CAR ;
                                                            DIG 4 ;
                                                            DUP 3 ;
                                                            COMPARE ;
                                                            LT ;
                                                            IF { DROP 6 ; PUSH nat 11 ; FAILWITH }
                                                               { DIG 4 ;
                                                                 SWAP ;
                                                                 DUP ;
                                                                 DUG 2 ;
                                                                 COMPARE ;
                                                                 LT ;
                                                                 IF { DROP 5 ; PUSH nat 13 ; FAILWITH }
                                                                    { DUP 4 ;
                                                                      DUP 6 ;
                                                                      GET 5 ;
                                                                      SUB ;
                                                                      ISNAT ;
                                                                      IF_NONE { PUSH nat 14 ; FAILWITH } {} ;
                                                                      SWAP ;
                                                                      DUP ;
                                                                      DUG 2 ;
                                                                      DUP 7 ;
                                                                      CAR ;
                                                                      SUB ;
                                                                      ISNAT ;
                                                                      IF_NONE { PUSH nat 15 ; FAILWITH } {} ;
                                                                      DUP 7 ;
                                                                      SENDER ;
                                                                      DIG 7 ;
                                                                      PUSH int 0 ;
                                                                      SUB ;
                                                                      SWAP ;
                                                                      PAIR ;
                                                                      SWAP ;
                                                                      PAIR ;
                                                                      UNPAIR 3 ;
                                                                      GET 15 ;
                                                                      CONTRACT %mintOrBurn (pair (int %quantity) (address %target)) ;
                                                                      IF_NONE { PUSH nat 12 ; FAILWITH } {} ;
                                                                      PUSH mutez 0 ;
                                                                      DIG 3 ;
                                                                      DIG 3 ;
                                                                      SWAP ;
                                                                      PAIR ;
                                                                      TRANSFER_TOKENS ;
                                                                      DUP 7 ;
                                                                      SELF_ADDRESS ;
                                                                      DUP 8 ;
                                                                      DUP 7 ;
                                                                      SWAP ;
                                                                      PAIR ;
                                                                      SWAP ;
                                                                      PAIR ;
                                                                      SWAP ;
                                                                      PAIR ;
                                                                      UNPAIR 4 ;
                                                                      GET 13 ;
                                                                      CONTRACT %transfer (pair address (pair address nat)) ;
                                                                      IF_NONE { PUSH nat 0 ; FAILWITH } {} ;
                                                                      PUSH mutez 0 ;
                                                                      DIG 4 ;
                                                                      DIG 4 ;
                                                                      PAIR ;
                                                                      DIG 3 ;
                                                                      PAIR ;
                                                                      TRANSFER_TOKENS ;
                                                                      DIG 6 ;
                                                                      CONTRACT unit ;
                                                                      IF_NONE { PUSH nat 9 ; FAILWITH } {} ;
                                                                      DUP 7 ;
                                                                      PUSH unit Unit ;
                                                                      TRANSFER_TOKENS ;
                                                                      DUP 8 ;
                                                                      DUP 8 ;
                                                                      DIG 9 ;
                                                                      GET 3 ;
                                                                      SUB ;
                                                                      UPDATE 3 ;
                                                                      DIG 5 ;
                                                                      UPDATE 5 ;
                                                                      DIG 4 ;
                                                                      UPDATE 1 ;
                                                                      DUP ;
                                                                      GET 17 ;
                                                                      SWAP ;
                                                                      DUP ;
                                                                      DUG 2 ;
                                                                      CAR ;
                                                                      SOME ;
                                                                      PUSH string "tokenPool" ;
                                                                      UPDATE ;
                                                                      PUSH mutez 1 ;
                                                                      DUP 3 ;
                                                                      GET 3 ;
                                                                      EDIV ;
                                                                      IF_NONE { PUSH string "DIV by 0" ; FAILWITH } {} ;
                                                                      CAR ;
                                                                      SOME ;
                                                                      PUSH string "xtzPool" ;
                                                                      UPDATE ;
                                                                      SWAP ;
                                                                      DUP ;
                                                                      DUG 2 ;
                                                                      GET 19 ;
                                                                      DIG 7 ;
                                                                      DIG 7 ;
                                                                      PUSH unit Unit ;
                                                                      RIGHT unit ;
                                                                      PAIR ;
                                                                      PAIR ;
                                                                      SOME ;
                                                                      SENDER ;
                                                                      UPDATE ;
                                                                      DUG 2 ;
                                                                      UPDATE 17 ;
                                                                      SWAP ;
                                                                      UPDATE 19 ;
                                                                      NIL operation ;
                                                                      DIG 2 ;
                                                                      CONS ;
                                                                      DIG 2 ;
                                                                      CONS ;
                                                                      DIG 2 ;
                                                                      CONS ;
                                                                      PAIR } } } } } }
                                           { UNPAIR ;
                                             DUP 3 ;
                                             GET 7 ;
                                             IF { DROP 3 ; PUSH nat 2 ; FAILWITH }
                                                { PUSH mutez 0 ;
                                                  AMOUNT ;
                                                  COMPARE ;
                                                  GT ;
                                                  IF { DROP 3 ; PUSH nat 10 ; FAILWITH }
                                                     { DUP 3 ;
                                                       GET 11 ;
                                                       SENDER ;
                                                       COMPARE ;
                                                       NEQ ;
                                                       IF { DROP 3 ; PUSH nat 20 ; FAILWITH }
                                                          { DUP 3 ;
                                                            GET 9 ;
                                                            IF { DROP 3 ; PUSH nat 22 ; FAILWITH }
                                                               { DUG 2 ; UPDATE 9 ; NIL operation ; DIG 2 ; SET_DELEGATE ; CONS ; PAIR } } } } } } }
                                   { IF_LEFT
                                       { IF_LEFT
                                           { SWAP ;
                                             DUP ;
                                             DUG 2 ;
                                             GET 7 ;
                                             IF { DROP 2 ; PUSH nat 2 ; FAILWITH }
                                                { PUSH mutez 0 ;
                                                  AMOUNT ;
                                                  COMPARE ;
                                                  GT ;
                                                  IF { DROP 2 ; PUSH nat 10 ; FAILWITH }
                                                     { SWAP ;
                                                       DUP ;
                                                       DUG 2 ;
                                                       GET 11 ;
                                                       SENDER ;
                                                       COMPARE ;
                                                       NEQ ;
                                                       IF { DROP 2 ; PUSH nat 23 ; FAILWITH }
                                                          { PUSH address "tz1Ke2h7sDdakHJQh8WX4Z372du1KChsksyU" ;
                                                            DUP 3 ;
                                                            GET 15 ;
                                                            COMPARE ;
                                                            NEQ ;
                                                            IF { DROP 2 ; PUSH nat 24 ; FAILWITH }
                                                               { UPDATE 15 ; NIL operation ; PAIR } } } } }
                                           { SWAP ;
                                             DUP ;
                                             DUG 2 ;
                                             GET 7 ;
                                             IF { DROP 2 ; PUSH nat 2 ; FAILWITH }
                                                { PUSH mutez 0 ;
                                                  AMOUNT ;
                                                  COMPARE ;
                                                  GT ;
                                                  IF { DROP 2 ; PUSH nat 10 ; FAILWITH }
                                                     { SWAP ;
                                                       DUP ;
                                                       DUG 2 ;
                                                       GET 11 ;
                                                       SENDER ;
                                                       COMPARE ;
                                                       NEQ ;
                                                       IF { DROP 2 ; PUSH nat 21 ; FAILWITH }
                                                          { UPDATE 11 ; NIL operation ; PAIR } } } } }
                                       { IF_LEFT
                                           { UNPAIR 5 ;
                                             CONTRACT %xtzToToken
                                               (pair (address %to) (pair (nat %minTokensBought) (timestamp %deadline))) ;
                                             IF_NONE { PUSH nat 31 ; FAILWITH } {} ;
                                             DUP 6 ;
                                             GET 7 ;
                                             IF { DROP 6 ; PUSH nat 2 ; FAILWITH }
                                                { PUSH mutez 0 ;
                                                  AMOUNT ;
                                                  COMPARE ;
                                                  GT ;
                                                  IF { DROP 6 ; PUSH nat 10 ; FAILWITH }
                                                     { DUP 5 ;
                                                       NOW ;
                                                       COMPARE ;
                                                       GE ;
                                                       IF { DROP 6 ; PUSH nat 3 ; FAILWITH }
                                                          { PUSH nat 9972 ;
                                                            DUP 5 ;
                                                            MUL ;
                                                            PUSH nat 10000 ;
                                                            DUP 8 ;
                                                            CAR ;
                                                            MUL ;
                                                            ADD ;
                                                            PUSH mutez 1 ;
                                                            DUP 8 ;
                                                            GET 3 ;
                                                            EDIV ;
                                                            IF_NONE { PUSH string "DIV by 0" ; FAILWITH } {} ;
                                                            CAR ;
                                                            PUSH nat 9972 ;
                                                            DUP 7 ;
                                                            MUL ;
                                                            MUL ;
                                                            EDIV ;
                                                            IF_NONE { PUSH string "DIV by 0" ; FAILWITH } {} ;
                                                            CAR ;
                                                            PUSH mutez 1 ;
                                                            SWAP ;
                                                            MUL ;
                                                            PUSH nat 3 ;
                                                            DUP 6 ;
                                                            MUL ;
                                                            PUSH nat 10000 ;
                                                            DUP 9 ;
                                                            CAR ;
                                                            MUL ;
                                                            ADD ;
                                                            PUSH mutez 1 ;
                                                            DUP 9 ;
                                                            GET 3 ;
                                                            EDIV ;
                                                            IF_NONE { PUSH string "DIV by 0" ; FAILWITH } {} ;
                                                            CAR ;
                                                            PUSH nat 3 ;
                                                            DUP 8 ;
                                                            MUL ;
                                                            MUL ;
                                                            EDIV ;
                                                            IF_NONE { PUSH string "DIV by 0" ; FAILWITH } {} ;
                                                            CAR ;
                                                            PUSH mutez 1 ;
                                                            SWAP ;
                                                            MUL ;
                                                            DUP 6 ;
                                                            DUP 9 ;
                                                            CAR ;
                                                            ADD ;
                                                            PUSH mutez 1 ;
                                                            DUP 10 ;
                                                            GET 3 ;
                                                            EDIV ;
                                                            IF_NONE { PUSH string "DIV by 0" ; FAILWITH } {} ;
                                                            CAR ;
                                                            DUP 8 ;
                                                            MUL ;
                                                            EDIV ;
                                                            IF_NONE { PUSH string "DIV by 0" ; FAILWITH } {} ;
                                                            CAR ;
                                                            PUSH mutez 1 ;
                                                            SWAP ;
                                                            MUL ;
                                                            DUP 7 ;
                                                            DUP 10 ;
                                                            CAR ;
                                                            ADD ;
                                                            DUP 3 ;
                                                            DUP 5 ;
                                                            DUP 12 ;
                                                            GET 3 ;
                                                            SUB ;
                                                            SUB ;
                                                            DUP 11 ;
                                                            GET 17 ;
                                                            DUP 3 ;
                                                            SOME ;
                                                            PUSH string "tokenPool" ;
                                                            UPDATE ;
                                                            PUSH mutez 1 ;
                                                            DUP 3 ;
                                                            EDIV ;
                                                            IF_NONE { PUSH string "DIV by 0" ; FAILWITH } {} ;
                                                            CAR ;
                                                            SOME ;
                                                            PUSH string "xtzPool" ;
                                                            UPDATE ;
                                                            PUSH mutez 1 ;
                                                            DIG 4 ;
                                                            EDIV ;
                                                            IF_NONE { PUSH string "DIV by 0" ; FAILWITH } {} ;
                                                            CAR ;
                                                            SOME ;
                                                            PUSH string "xtzVolume" ;
                                                            UPDATE ;
                                                            DIG 10 ;
                                                            DIG 3 ;
                                                            UPDATE 1 ;
                                                            DIG 2 ;
                                                            UPDATE 3 ;
                                                            SWAP ;
                                                            UPDATE 17 ;
                                                            DUP ;
                                                            SENDER ;
                                                            SELF_ADDRESS ;
                                                            DIG 9 ;
                                                            SWAP ;
                                                            PAIR ;
                                                            SWAP ;
                                                            PAIR ;
                                                            SWAP ;
                                                            PAIR ;
                                                            UNPAIR 4 ;
                                                            GET 13 ;
                                                            CONTRACT %transfer (pair address (pair address nat)) ;
                                                            IF_NONE { PUSH nat 0 ; FAILWITH } {} ;
                                                            PUSH mutez 0 ;
                                                            DIG 4 ;
                                                            DIG 4 ;
                                                            PAIR ;
                                                            DIG 3 ;
                                                            PAIR ;
                                                            TRANSFER_TOKENS ;
                                                            DIG 4 ;
                                                            DIG 4 ;
                                                            DIG 6 ;
                                                            DIG 6 ;
                                                            DIG 7 ;
                                                            SWAP ;
                                                            PAIR ;
                                                            SWAP ;
                                                            PAIR ;
                                                            TRANSFER_TOKENS ;
                                                            DUP 3 ;
                                                            GET 20 ;
                                                            CONTRACT unit ;
                                                            IF_NONE { PUSH nat 9 ; FAILWITH } {} ;
                                                            DUP 5 ;
                                                            PUSH unit Unit ;
                                                            TRANSFER_TOKENS ;
                                                            DIG 3 ;
                                                            PUSH mutez 0 ;
                                                            DIG 5 ;
                                                            COMPARE ;
                                                            EQ ;
                                                            IF { SWAP ; DROP ; NIL operation ; DIG 2 ; CONS ; DIG 2 ; CONS }
                                                               { NIL operation ; DIG 2 ; CONS ; DIG 2 ; CONS ; DIG 2 ; CONS } ;
                                                            PAIR } } } }
                                           { UNPAIR 4 ;
                                             DUP 5 ;
                                             GET 7 ;
                                             IF { DROP 5 ; PUSH nat 2 ; FAILWITH }
                                                { DIG 3 ;
                                                  NOW ;
                                                  COMPARE ;
                                                  GE ;
                                                  IF { DROP 4 ; PUSH nat 3 ; FAILWITH }
                                                     { PUSH mutez 0 ;
                                                       AMOUNT ;
                                                       COMPARE ;
                                                       GT ;
                                                       IF { DROP 4 ; PUSH nat 10 ; FAILWITH }
                                                          { PUSH nat 9972 ;
                                                            DUP 3 ;
                                                            MUL ;
                                                            PUSH nat 10000 ;
                                                            DUP 6 ;
                                                            CAR ;
                                                            MUL ;
                                                            ADD ;
                                                            PUSH mutez 1 ;
                                                            DUP 6 ;
                                                            GET 3 ;
                                                            EDIV ;
                                                            IF_NONE { PUSH string "DIV by 0" ; FAILWITH } {} ;
                                                            CAR ;
                                                            PUSH nat 9972 ;
                                                            DUP 5 ;
                                                            MUL ;
                                                            MUL ;
                                                            EDIV ;
                                                            IF_NONE { PUSH string "DIV by 0" ; FAILWITH } {} ;
                                                            CAR ;
                                                            PUSH mutez 1 ;
                                                            SWAP ;
                                                            MUL ;
                                                            DIG 3 ;
                                                            SWAP ;
                                                            DUP ;
                                                            DUG 2 ;
                                                            COMPARE ;
                                                            LT ;
                                                            IF { DROP ; PUSH nat 8 ; FAILWITH } {} ;
                                                            PUSH nat 3 ;
                                                            DUP 4 ;
                                                            MUL ;
                                                            PUSH nat 10000 ;
                                                            DUP 6 ;
                                                            CAR ;
                                                            MUL ;
                                                            ADD ;
                                                            PUSH mutez 1 ;
                                                            DUP 6 ;
                                                            GET 3 ;
                                                            EDIV ;
                                                            IF_NONE { PUSH string "DIV by 0" ; FAILWITH } {} ;
                                                            CAR ;
                                                            PUSH nat 3 ;
                                                            DUP 6 ;
                                                            MUL ;
                                                            MUL ;
                                                            EDIV ;
                                                            IF_NONE { PUSH string "DIV by 0" ; FAILWITH } {} ;
                                                            CAR ;
                                                            PUSH mutez 1 ;
                                                            SWAP ;
                                                            MUL ;
                                                            DUP 4 ;
                                                            DUP 6 ;
                                                            CAR ;
                                                            ADD ;
                                                            PUSH mutez 1 ;
                                                            DUP 7 ;
                                                            GET 3 ;
                                                            EDIV ;
                                                            IF_NONE { PUSH string "DIV by 0" ; FAILWITH } {} ;
                                                            CAR ;
                                                            DUP 6 ;
                                                            MUL ;
                                                            EDIV ;
                                                            IF_NONE { PUSH string "DIV by 0" ; FAILWITH } {} ;
                                                            CAR ;
                                                            PUSH mutez 1 ;
                                                            SWAP ;
                                                            MUL ;
                                                            DUP 6 ;
                                                            SENDER ;
                                                            SELF_ADDRESS ;
                                                            DUP 8 ;
                                                            SWAP ;
                                                            PAIR ;
                                                            SWAP ;
                                                            PAIR ;
                                                            SWAP ;
                                                            PAIR ;
                                                            UNPAIR 4 ;
                                                            GET 13 ;
                                                            CONTRACT %transfer (pair address (pair address nat)) ;
                                                            IF_NONE { PUSH nat 0 ; FAILWITH } {} ;
                                                            PUSH mutez 0 ;
                                                            DIG 4 ;
                                                            DIG 4 ;
                                                            PAIR ;
                                                            DIG 3 ;
                                                            PAIR ;
                                                            TRANSFER_TOKENS ;
                                                            DIG 4 ;
                                                            CONTRACT unit ;
                                                            IF_NONE { PUSH nat 9 ; FAILWITH } {} ;
                                                            DUP 5 ;
                                                            PUSH unit Unit ;
                                                            TRANSFER_TOKENS ;
                                                            DUP 7 ;
                                                            GET 20 ;
                                                            CONTRACT unit ;
                                                            IF_NONE { PUSH nat 9 ; FAILWITH } {} ;
                                                            DUP 5 ;
                                                            PUSH unit Unit ;
                                                            TRANSFER_TOKENS ;
                                                            DIG 6 ;
                                                            DUP 8 ;
                                                            CAR ;
                                                            ADD ;
                                                            DUP 6 ;
                                                            DIG 7 ;
                                                            DUP 9 ;
                                                            GET 3 ;
                                                            SUB ;
                                                            SUB ;
                                                            DUP 8 ;
                                                            GET 17 ;
                                                            DUP 3 ;
                                                            SOME ;
                                                            PUSH string "tokenPool" ;
                                                            UPDATE ;
                                                            PUSH mutez 1 ;
                                                            DUP 3 ;
                                                            EDIV ;
                                                            IF_NONE { PUSH string "DIV by 0" ; FAILWITH } {} ;
                                                            CAR ;
                                                            SOME ;
                                                            PUSH string "xtzPool" ;
                                                            UPDATE ;
                                                            PUSH mutez 1 ;
                                                            DIG 7 ;
                                                            EDIV ;
                                                            IF_NONE { PUSH string "DIV by 0" ; FAILWITH } {} ;
                                                            CAR ;
                                                            SOME ;
                                                            PUSH string "xtzVolume" ;
                                                            UPDATE ;
                                                            DIG 7 ;
                                                            DIG 3 ;
                                                            UPDATE 1 ;
                                                            DIG 2 ;
                                                            UPDATE 3 ;
                                                            SWAP ;
                                                            UPDATE 17 ;
                                                            PUSH mutez 0 ;
                                                            DIG 5 ;
                                                            COMPARE ;
                                                            EQ ;
                                                            IF { SWAP ; DROP ; NIL operation ; DIG 2 ; CONS ; DIG 2 ; CONS }
                                                               { NIL operation ; DIG 2 ; CONS ; DIG 2 ; CONS ; DIG 2 ; CONS } ;
                                                            PAIR } } } } } } }
                               { IF_LEFT
                                   { IF_LEFT
                                       { SWAP ;
                                         DUP ;
                                         DUG 2 ;
                                         GET 20 ;
                                         SENDER ;
                                         COMPARE ;
                                         NEQ ;
                                         IF { DROP 2 ; PUSH nat 40 ; FAILWITH }
                                            { UPDATE 20 ; NIL operation ; PAIR } }
                                       { DROP ;
                                         SOURCE ;
                                         SENDER ;
                                         COMPARE ;
                                         NEQ ;
                                         IF { DROP ; PUSH nat 25 ; FAILWITH }
                                            { PUSH mutez 0 ;
                                              AMOUNT ;
                                              COMPARE ;
                                              GT ;
                                              IF { DROP ; PUSH nat 10 ; FAILWITH }
                                                 { DUP ;
                                                   GET 7 ;
                                                   IF { DROP ; PUSH nat 33 ; FAILWITH }
                                                      { SELF %updateTokenPoolInternal ;
                                                        SWAP ;
                                                        DUP ;
                                                        DUG 2 ;
                                                        GET 13 ;
                                                        CONTRACT %getBalance (pair address (contract nat)) ;
                                                        IF_NONE { PUSH nat 28 ; FAILWITH } {} ;
                                                        PUSH mutez 0 ;
                                                        DIG 2 ;
                                                        SELF_ADDRESS ;
                                                        PAIR ;
                                                        TRANSFER_TOKENS ;
                                                        SWAP ;
                                                        PUSH bool True ;
                                                        UPDATE 7 ;
                                                        NIL operation ;
                                                        DIG 2 ;
                                                        CONS ;
                                                        PAIR } } } } }
                                   { IF_LEFT
                                       { SWAP ;
                                         DUP ;
                                         DUG 2 ;
                                         GET 13 ;
                                         SENDER ;
                                         COMPARE ;
                                         NEQ ;
                                         DUP 3 ;
                                         GET 7 ;
                                         NOT ;
                                         OR ;
                                         IF { DROP 2 ; PUSH nat 29 ; FAILWITH }
                                            { PUSH mutez 0 ;
                                              AMOUNT ;
                                              COMPARE ;
                                              GT ;
                                              IF { DROP 2 ; PUSH nat 10 ; FAILWITH }
                                                 { UPDATE 1 ; PUSH bool False ; UPDATE 7 ; NIL operation ; PAIR } } }
                                       { UNPAIR 3 ;
                                         DUP 4 ;
                                         GET 7 ;
                                         IF { DROP 4 ; PUSH nat 2 ; FAILWITH }
                                            { DIG 2 ;
                                              NOW ;
                                              COMPARE ;
                                              GE ;
                                              IF { DROP 3 ; PUSH nat 3 ; FAILWITH }
                                                 { PUSH mutez 1 ;
                                                   DUP 4 ;
                                                   GET 3 ;
                                                   EDIV ;
                                                   IF_NONE { PUSH string "DIV by 0" ; FAILWITH } {} ;
                                                   CAR ;
                                                   AMOUNT ;
                                                   PUSH mutez 1 ;
                                                   SWAP ;
                                                   EDIV ;
                                                   IF_NONE { PUSH string "DIV by 0" ; FAILWITH } {} ;
                                                   CAR ;
                                                   PUSH nat 9972 ;
                                                   SWAP ;
                                                   DUP ;
                                                   DUG 2 ;
                                                   MUL ;
                                                   PUSH nat 10000 ;
                                                   DIG 3 ;
                                                   MUL ;
                                                   ADD ;
                                                   DUP 5 ;
                                                   CAR ;
                                                   PUSH nat 9972 ;
                                                   DUP 4 ;
                                                   MUL ;
                                                   MUL ;
                                                   EDIV ;
                                                   IF_NONE { PUSH string "DIV by 0" ; FAILWITH } {} ;
                                                   CAR ;
                                                   DIG 3 ;
                                                   SWAP ;
                                                   DUP ;
                                                   DUG 2 ;
                                                   COMPARE ;
                                                   LT ;
                                                   IF { DROP ; PUSH nat 18 ; FAILWITH } {} ;
                                                   PUSH nat 10000 ;
                                                   PUSH nat 3 ;
                                                   DUP 4 ;
                                                   MUL ;
                                                   EDIV ;
                                                   IF_NONE { PUSH string "DIV by 0" ; FAILWITH } {} ;
                                                   CAR ;
                                                   PUSH mutez 1 ;
                                                   SWAP ;
                                                   MUL ;
                                                   SWAP ;
                                                   DUP ;
                                                   DUG 2 ;
                                                   DUP 6 ;
                                                   CAR ;
                                                   SUB ;
                                                   ISNAT ;
                                                   IF_NONE { PUSH nat 19 ; FAILWITH } {} ;
                                                   SWAP ;
                                                   DUP ;
                                                   DUG 2 ;
                                                   AMOUNT ;
                                                   DUP 8 ;
                                                   GET 3 ;
                                                   ADD ;
                                                   SUB ;
                                                   DIG 6 ;
                                                   SWAP ;
                                                   UPDATE 3 ;
                                                   SWAP ;
                                                   UPDATE 1 ;
                                                   DUP ;
                                                   GET 17 ;
                                                   SWAP ;
                                                   DUP ;
                                                   DUG 2 ;
                                                   CAR ;
                                                   SOME ;
                                                   PUSH string "tokenPool" ;
                                                   UPDATE ;
                                                   PUSH mutez 1 ;
                                                   DUP 3 ;
                                                   GET 3 ;
                                                   EDIV ;
                                                   IF_NONE { PUSH string "DIV by 0" ; FAILWITH } {} ;
                                                   CAR ;
                                                   SOME ;
                                                   PUSH string "xtzPool" ;
                                                   UPDATE ;
                                                   DIG 4 ;
                                                   SOME ;
                                                   PUSH string "xtzVolume" ;
                                                   UPDATE ;
                                                   UPDATE 17 ;
                                                   DUP ;
                                                   SELF_ADDRESS ;
                                                   DIG 5 ;
                                                   DIG 5 ;
                                                   SWAP ;
                                                   PAIR ;
                                                   SWAP ;
                                                   PAIR ;
                                                   SWAP ;
                                                   PAIR ;
                                                   UNPAIR 4 ;
                                                   GET 13 ;
                                                   CONTRACT %transfer (pair address (pair address nat)) ;
                                                   IF_NONE { PUSH nat 0 ; FAILWITH } {} ;
                                                   PUSH mutez 0 ;
                                                   DIG 4 ;
                                                   DIG 4 ;
                                                   PAIR ;
                                                   DIG 3 ;
                                                   PAIR ;
                                                   TRANSFER_TOKENS ;
                                                   SWAP ;
                                                   DUP ;
                                                   DUG 2 ;
                                                   GET 20 ;
                                                   CONTRACT unit ;
                                                   IF_NONE { PUSH nat 9 ; FAILWITH } {} ;
                                                   DUP 4 ;
                                                   PUSH unit Unit ;
                                                   TRANSFER_TOKENS ;
                                                   DIG 2 ;
                                                   PUSH mutez 0 ;
                                                   DIG 4 ;
                                                   COMPARE ;
                                                   EQ ;
                                                   IF { SWAP ; DROP ; NIL operation ; DIG 2 ; CONS }
                                                      { NIL operation ; DIG 2 ; CONS ; DIG 2 ; CONS } ;
                                                   PAIR } } } } } } } ;
                  PAIR ;
                  DUP 5 ;
                  CAR ;
                  CDR ;
                  CDR ;
                  CAR ;
                  DUP 3 ;
                  SOME ;
                  SENDER ;
                  UPDATE ;
                  DUP 6 ;
                  CAR ;
                  CDR ;
                  CAR ;
                  CAR ;
                  DUP 3 ;
                  CDR ;
                  DIG 4 ;
                  DUP 8 ;
                  CAR ;
                  CAR ;
                  CAR ;
                  CDR ;
                  DUP 9 ;
                  CAR ;
                  CAR ;
                  CDR ;
                  CDR ;
                  SWAP ;
                  PAIR ;
                  SWAP ;
                  PAIR ;
                  SWAP ;
                  PAIR ;
                  SWAP ;
                  PAIR ;
                  SWAP ;
                  PAIR ;
                  PUSH mutez 0 ;
                  NONE key_hash ;
                  PAIR ;
                  PAIR ;
                  UNPPAIIR ;
                  CREATE_CONTRACT
                    { parameter
                        (or (or (or (pair %approve (address %spender) (nat %value))
                                    (pair %getAllowance
                                       (pair %request (address %owner) (address %spender))
                                       (contract %callback nat)))
                                (or (pair %getBalance (address %owner) (contract %callback nat))
                                    (pair %getTotalSupply (unit %request) (contract %callback nat))))
                            (or (pair %mintOrBurn (int %quantity) (address %target))
                                (pair %transfer (address %from) (pair (address %to) (nat %value))))) ;
                      storage
                        (pair (big_map %tokens address nat)
                              (pair (big_map %allowances (pair (address %owner) (address %spender)) nat)
                                    (pair (address %admin)
                                          (pair (nat %total_supply)
                                                (pair (big_map %metadata string bytes)
                                                      (big_map %token_metadata nat (pair (nat %token_id) (map %token_info string bytes)))))))) ;
                      code { UNPAIR ;
                             PUSH mutez 0 ;
                             AMOUNT ;
                             COMPARE ;
                             NEQ ;
                             IF { PUSH string "DontSendTez" ; FAILWITH } {} ;
                             IF_LEFT
                               { IF_LEFT
                                   { IF_LEFT
                                       { SWAP ;
                                         DUP ;
                                         DUG 2 ;
                                         GET 3 ;
                                         SENDER ;
                                         DUP 3 ;
                                         CAR ;
                                         SWAP ;
                                         PAIR ;
                                         PUSH nat 0 ;
                                         DUP 4 ;
                                         CDR ;
                                         COMPARE ;
                                         GT ;
                                         PUSH nat 0 ;
                                         DUP 4 ;
                                         DUP 4 ;
                                         GET ;
                                         IF_NONE { PUSH nat 0 } {} ;
                                         COMPARE ;
                                         GT ;
                                         AND ;
                                         IF { PUSH string "UnsafeAllowanceChange" ; FAILWITH } {} ;
                                         DIG 3 ;
                                         DIG 2 ;
                                         DIG 3 ;
                                         CDR ;
                                         PUSH nat 0 ;
                                         SWAP ;
                                         DUP ;
                                         DUG 2 ;
                                         COMPARE ;
                                         EQ ;
                                         IF { DROP ; NONE nat } { SOME } ;
                                         DIG 3 ;
                                         UPDATE ;
                                         UPDATE 3 ;
                                         NIL operation ;
                                         PAIR }
                                       { SWAP ;
                                         DUP ;
                                         DUG 2 ;
                                         NIL operation ;
                                         DUP 3 ;
                                         CDR ;
                                         PUSH mutez 0 ;
                                         DIG 5 ;
                                         GET 3 ;
                                         DIG 5 ;
                                         CAR ;
                                         GET ;
                                         IF_NONE { PUSH nat 0 } {} ;
                                         TRANSFER_TOKENS ;
                                         CONS ;
                                         PAIR } }
                                   { IF_LEFT
                                       { SWAP ;
                                         DUP ;
                                         DUG 2 ;
                                         NIL operation ;
                                         DUP 3 ;
                                         CDR ;
                                         PUSH mutez 0 ;
                                         DIG 5 ;
                                         CAR ;
                                         DIG 5 ;
                                         CAR ;
                                         GET ;
                                         IF_NONE { PUSH nat 0 } {} ;
                                         TRANSFER_TOKENS ;
                                         CONS ;
                                         PAIR }
                                       { SWAP ;
                                         DUP ;
                                         DUG 2 ;
                                         NIL operation ;
                                         DIG 2 ;
                                         CDR ;
                                         PUSH mutez 0 ;
                                         DIG 4 ;
                                         GET 7 ;
                                         TRANSFER_TOKENS ;
                                         CONS ;
                                         PAIR } } }
                               { IF_LEFT
                                   { SWAP ;
                                     DUP ;
                                     DUG 2 ;
                                     GET 5 ;
                                     SENDER ;
                                     COMPARE ;
                                     NEQ ;
                                     IF { PUSH string "OnlyAdmin" ; FAILWITH } {} ;
                                     DUP ;
                                     CAR ;
                                     DUP 3 ;
                                     CAR ;
                                     DUP 3 ;
                                     CDR ;
                                     GET ;
                                     IF_NONE { PUSH nat 0 } {} ;
                                     ADD ;
                                     ISNAT ;
                                     IF_NONE
                                       { PUSH string "Cannot burn more than the target's balance." ; FAILWITH }
                                       {} ;
                                     SWAP ;
                                     DUP ;
                                     DUG 2 ;
                                     CAR ;
                                     DUP 4 ;
                                     GET 7 ;
                                     ADD ;
                                     ABS ;
                                     DIG 3 ;
                                     DUP ;
                                     CAR ;
                                     PUSH nat 0 ;
                                     DUP 5 ;
                                     COMPARE ;
                                     EQ ;
                                     IF { DIG 3 ; DROP ; NONE nat } { DIG 3 ; SOME } ;
                                     DIG 4 ;
                                     CDR ;
                                     UPDATE ;
                                     UPDATE 1 ;
                                     SWAP ;
                                     UPDATE 7 ;
                                     NIL operation ;
                                     PAIR }
                                   { SWAP ;
                                     DUP ;
                                     DUG 2 ;
                                     GET 3 ;
                                     DUP 3 ;
                                     CAR ;
                                     DUP 3 ;
                                     CAR ;
                                     SENDER ;
                                     COMPARE ;
                                     EQ ;
                                     IF { SWAP }
                                        { DUP 3 ;
                                          CAR ;
                                          SENDER ;
                                          SWAP ;
                                          PAIR ;
                                          DUP 4 ;
                                          GET 4 ;
                                          DUP 4 ;
                                          DUP 3 ;
                                          GET ;
                                          IF_NONE { PUSH nat 0 } {} ;
                                          SUB ;
                                          ISNAT ;
                                          IF_NONE { PUSH string "NotEnoughAllowance" ; FAILWITH } {} ;
                                          DIG 3 ;
                                          PUSH nat 0 ;
                                          DUP 3 ;
                                          COMPARE ;
                                          EQ ;
                                          IF { SWAP ; DROP ; NONE nat } { SWAP ; SOME } ;
                                          DIG 2 ;
                                          UPDATE } ;
                                     DUP 3 ;
                                     GET 4 ;
                                     DUP 3 ;
                                     DUP 5 ;
                                     CAR ;
                                     GET ;
                                     IF_NONE { PUSH nat 0 } {} ;
                                     SUB ;
                                     ISNAT ;
                                     IF_NONE { PUSH string "NotEnoughBalance" ; FAILWITH } {} ;
                                     DIG 2 ;
                                     PUSH nat 0 ;
                                     DUP 3 ;
                                     COMPARE ;
                                     EQ ;
                                     IF { SWAP ; DROP ; NONE nat } { SWAP ; SOME } ;
                                     DUP 4 ;
                                     CAR ;
                                     UPDATE ;
                                     DUP 3 ;
                                     GET 4 ;
                                     SWAP ;
                                     DUP ;
                                     DUG 2 ;
                                     DUP 5 ;
                                     GET 3 ;
                                     GET ;
                                     IF_NONE { PUSH nat 0 } {} ;
                                     ADD ;
                                     SWAP ;
                                     PUSH nat 0 ;
                                     DUP 3 ;
                                     COMPARE ;
                                     EQ ;
                                     IF { SWAP ; DROP ; NONE nat } { SWAP ; SOME } ;
                                     DIG 3 ;
                                     GET 3 ;
                                     UPDATE ;
                                     DIG 2 ;
                                     SWAP ;
                                     UPDATE 1 ;
                                     SWAP ;
                                     UPDATE 3 ;
                                     NIL operation ;
                                     PAIR } } } } ;
                  PAIR ;
                  DUP 5 ;
                  CDR ;
                  CDR ;
                  DUP 3 ;
                  CDR ;
                  SOME ;
                  DUP 6 ;
                  CAR ;
                  UPDATE ;
                  DUP 6 ;
                  CDR ;
                  CAR ;
                  DUP 4 ;
                  CDR ;
                  SOME ;
                  DUP 8 ;
                  CAR ;
                  CAR ;
                  CAR ;
                  CAR ;
                  UPDATE ;
                  PAIR ;
                  DUP 6 ;
                  CAR ;
                  CDR ;
                  CDR ;
                  CDR ;
                  DUP 7 ;
                  CAR ;
                  CDR ;
                  CDR ;
                  CAR ;
                  PAIR ;
                  DUP 7 ;
                  CAR ;
                  CDR ;
                  CAR ;
                  CDR ;
                  DUP 8 ;
                  CAR ;
                  CDR ;
                  CAR ;
                  CAR ;
                  PAIR ;
                  PAIR ;
                  DUP 7 ;
                  CAR ;
                  CAR ;
                  CDR ;
                  CDR ;
                  DUP 8 ;
                  CAR ;
                  CAR ;
                  CDR ;
                  CAR ;
                  PAIR ;
                  DUP 8 ;
                  CAR ;
                  CAR ;
                  CAR ;
                  CDR ;
                  PUSH nat 1 ;
                  DIG 9 ;
                  CAR ;
                  CAR ;
                  CAR ;
                  CAR ;
                  ADD ;
                  PAIR ;
                  PAIR ;
                  PAIR ;
                  PAIR ;
                  DUP 5 ;
                  CAR ;
                  CONTRACT %transfer (pair (address %from) (pair (address %to) (nat %value))) ;
                  IF_NONE { PUSH nat 0 ; FAILWITH } {} ;
                  PUSH mutez 0 ;
                  SENDER ;
                  DUP 6 ;
                  CDR ;
                  DIG 8 ;
                  CDR ;
                  SWAP ;
                  PAIR ;
                  SWAP ;
                  PAIR ;
                  TRANSFER_TOKENS ;
                  DIG 4 ;
                  CONTRACT %setLqtAddress (pair (address %dex_address) (address %lqt_address)) ;
                  IF_NONE { PUSH nat 2 ; FAILWITH } {} ;
                  PUSH mutez 0 ;
                  DUP 5 ;
                  CDR ;
                  DUP 7 ;
                  CDR ;
                  PAIR ;
                  TRANSFER_TOKENS ;
                  DIG 2 ;
                  NIL operation ;
                  DIG 2 ;
                  CONS ;
                  DIG 2 ;
                  CONS ;
                  DIG 2 ;
                  CAR ;
                  CONS ;
                  DIG 2 ;
                  CAR ;
                  CONS ;
                  PAIR } }
           { SELF_ADDRESS ;
             SWAP ;
             DIG 2 ;
             SWAP ;
             PAIR ;
             SWAP ;
             PAIR ;
             UNPAIR 3 ;
             SENDER ;
             COMPARE ;
             NEQ ;
             IF { DROP 2 ; PUSH string "only self can call this entrypoint" ; FAILWITH }
                { DUP ;
                  CAR ;
                  CONTRACT %setLqtAddress address ;
                  IF_NONE { PUSH nat 1 ; FAILWITH } {} ;
                  PUSH mutez 0 ;
                  DIG 2 ;
                  CDR ;
                  TRANSFER_TOKENS ;
                  SWAP ;
                  NIL operation ;
                  DIG 2 ;
                  CONS ;
                  PAIR } } } }

